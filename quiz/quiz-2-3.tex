\documentclass[10pt,a4paper,american]{exam}
\usepackage{../misc/macros/joc}
\usepackage{../misc/fonts/fonts}
\usepackage{../misc/macros/classhandout}

\title{Applied Cryptography - Quiz 2.3: Secure Messaging}
\author{Nadim Kobeissi}
\subject{Multiple choice quiz to help you see how much you remembered from the secure messaging session of the Applied Cryptography course.}
\keywords{cryptography, security, encryption, authentication, secure messaging, PGP, OTR, Signal, forward secrecy, deniability}

\begin{document}
\classhandoutheader
\section*{Quiz 2.3: Secure Messaging}

\begin{tcolorbox}[colframe=OliveGreen!30!white,colback=OliveGreen!5!white]
	This completely optional quick quiz acts as a learning aid to help you find out how much you absorbed from our secure messaging session.\footnote{\url{https://appliedcryptography.page/slides/\#2-3}} Remember, this is just for fun and to help you identify areas you might want to review. Each question has three possible answers, but only one is correct. Take your time, and when you're done, check your answers against the answer key at the end. Good luck!
\end{tcolorbox}

\subsection*{Questions}

\begin{questions}
	\question What was the main usability problem identified in ``Why Johnny Can't Encrypt'' (1999)?
	\begin{randomizechoices}
		\choice PGP was too slow to encrypt messages
		\CorrectChoice Users couldn't understand public key concepts and made dangerous errors
		\choice The software required command-line expertise
	\end{randomizechoices}

	\question What is forward secrecy in secure messaging?
	\begin{randomizechoices}
		\choice Messages can be forwarded to other users securely
		\CorrectChoice Past messages remain secure even if long-term keys are compromised
		\choice Future messages are pre-encrypted for efficiency
	\end{randomizechoices}

	\question In OTR, what enables deniable authentication?
	\begin{randomizechoices}
		\choice Using digital signatures that expire quickly
		\CorrectChoice Using MACs instead of signatures and revealing old MAC keys
		\choice Encrypting messages with temporary passwords
	\end{randomizechoices}

	\question What is the purpose of the HMAC in the SIGMA protocol?
	\begin{randomizechoices}
		\choice To encrypt the identity information
		\choice To speed up the key exchange process
		\CorrectChoice To bind identities to the key exchange and prevent identity misbinding attacks
	\end{randomizechoices}

	\question Why is HKDF preferred over simple hashing for key derivation?
	\begin{randomizechoices}
		\choice It's faster than SHA-256
		\CorrectChoice It provides domain separation and provable security properties
		\choice It produces longer keys than regular hash functions
	\end{randomizechoices}

	\question What makes Signal's X3DH protocol asynchronous?
	\begin{randomizechoices}
		\CorrectChoice It uses pre-keys uploaded to a server so key exchange works when Bob is offline
		\choice It delays message delivery until both parties are online
		\choice It uses quantum-resistant algorithms
	\end{randomizechoices}

	\question In Signal's Double Ratchet, what are the two types of ratcheting?
	\begin{randomizechoices}
		\choice Forward ratchet and backward ratchet
		\CorrectChoice Symmetric ratchet (HMAC chain) and DH ratchet (ephemeral keys)
		\choice Encryption ratchet and decryption ratchet
	\end{randomizechoices}

	\question What is post-compromise security?
	\begin{randomizechoices}
		\choice The ability to detect when a system has been compromised
		\choice Messages sent before a compromise remain secure
		\CorrectChoice Future messages become secure again after recovery from compromise
	\end{randomizechoices}

	\question According to the 2024 impossibility results, why can't real messaging apps achieve perfect PCS?
	\begin{randomizechoices}
		\choice The Double Ratchet algorithm has a fundamental flaw
		\CorrectChoice Real apps must handle state loss and allow recovery, creating permanent vulnerabilities
		\choice Quantum computers will eventually break all encryption
	\end{randomizechoices}

	\question What is Signal's approach to metadata protection with Sealed Sender?
	\begin{randomizechoices}
		\choice All metadata is deleted immediately after message delivery
		\CorrectChoice Sender identity is encrypted in an envelope so the server can't see who sent messages
		\choice Messages are routed through multiple servers to hide the sender
	\end{randomizechoices}

	\question What security property does PGP provide that OTR deliberately avoids?
	\begin{randomizechoices}
		\choice Forward secrecy
		\CorrectChoice Non-repudiation (permanent cryptographic proof of authorship)
		\choice Perfect forward secrecy
	\end{randomizechoices}

	\question In the context of secure messaging, what is a replay attack?
	\begin{randomizechoices}
		\CorrectChoice Resending valid protocol messages later to cause confusion or duplicate actions
		\choice Playing back encrypted voice messages
		\choice Copying someone's encryption keys
	\end{randomizechoices}

	\question Why does Signal allow up to 40 concurrent sessions per conversation?
	\begin{randomizechoices}
		\choice To support up to 40 devices per user
		\CorrectChoice To handle desync events and improve usability at the cost of security
		\choice To enable group chats with up to 40 members
	\end{randomizechoices}

	\question What is the main difference between Telegram's cloud chats and secret chats?
	\begin{randomizechoices}
		\choice Cloud chats are faster than secret chats
		\CorrectChoice Cloud chats are encrypted to the server (not E2E), secret chats use E2E encryption
		\choice Secret chats use stronger encryption algorithms
	\end{randomizechoices}

	\question How does WhatsApp's Sender Keys approach scale group messaging?
	\begin{randomizechoices}
		\choice Each member encrypts to every other member individually
		\CorrectChoice Members share a sender key allowing one encryption per message regardless of group size
		\choice The server decrypts and re-encrypts messages for each recipient
	\end{randomizechoices}

	\question What is TreeKEM in the MLS protocol?
	\begin{randomizechoices}
		\CorrectChoice A tree structure for managing group key agreement with logarithmic scaling
		\choice A method for storing encrypted messages in a tree database
		\choice A key escrow mechanism for law enforcement
	\end{randomizechoices}

	\question What attack on OTRv2 exploits MAC key revelation and message ordering?
	\begin{randomizechoices}
		\choice Version rollback attack
		\CorrectChoice Message integrity attack allowing forged messages with revealed MAC keys
		\choice Key compromise impersonation attack
	\end{randomizechoices}

	\question Why did the Chelsea Manning/Adrian Lamo case show that cryptographic deniability has limitations?
	\begin{randomizechoices}
		\choice The encryption was broken by the FBI
		\CorrectChoice Courts don't require cryptographic proof and accept testimony and context as evidence
		\choice OTR wasn't actually used in their conversation
	\end{randomizechoices}

	\question What is the computational complexity of sending a message in MLS compared to Signal's pairwise approach?
	\begin{randomizechoices}
		\choice MLS: O(n), Signal: O(1)
		\choice MLS: O(nÂ²), Signal: O(n)
		\CorrectChoice MLS: O(log n), Signal: O(n)
	\end{randomizechoices}

	\question What vulnerability was found in Signal's Sealed Sender through statistical disclosure attacks?
	\begin{randomizechoices}
		\choice The encryption could be broken with enough messages
		\CorrectChoice Reply patterns create timing epochs that reveal communication relationships
		\choice Sender certificates could be forged by attackers
	\end{randomizechoices}

\end{questions}

\clearpage

\subsection*{Answers}
\printkeytable

\end{document}
