\documentclass[10pt,a4paper,american]{article}
\newcommand{\aublogopath}{../../website/res/img/aub_black.png}
\usepackage{../../misc/macros/joc}
\usepackage{../../misc/fonts/fonts}
\usepackage{../../misc/macros/classhandout}

\begin{document}

\classhandoutheader

\section*{Problem Set 5: End-to-End Encrypted Cloud Protocol Design}

\begin{tcolorbox}[colframe=OliveGreen!30!white,colback=OliveGreen!5!white]
	\textbf{Instructions:} This problem set focuses on creative protocol design for end-to-end encrypted cloud storage based on topic 2.4\footnote{\url{https://appliedcryptography.page/slides/\#2-4}} of the course. Unlike previous problem sets, this assignment is intentionally open-ended and requires you to design, analyze, and justify your own cryptographic solutions. Submit your solutions as a neatly formatted PDF with clear diagrams and specifications. You are encouraged to collaborate with classmates in studying the material, but your submitted protocol designs must be your own work.
\end{tcolorbox}

\section{Protocol Design Challenge (100 points)}

You have been hired by a startup that wants to build a new end-to-end encrypted cloud storage service. Learning from the failures of MEGA and Nextcloud, they want a formally analyzable design that provides strong security guarantees while remaining practical and user-friendly.

\subsection{Part 1: Threat Model and Requirements (25 points)}

Design a comprehensive threat model and requirements specification for your E2EE cloud storage system.

\begin{enumerate}
	\item \textbf{Threat Model (15 points):}
	      \begin{itemize}
		      \item Define your adversary's capabilities. Consider both passive and active attacks, including a malicious service provider.
		      \item What attacks are in scope? What attacks are explicitly out of scope?
		      \item How do you handle the case where the adversary compromises user devices at different points in time?
		      \item Address the ``mud puddle test'' - what happens when a user loses their device and all credentials?
	      \end{itemize}

	\item \textbf{Functional Requirements (10 points):}
	      \begin{itemize}
		      \item What features must your system support? (Consider: file storage, sharing, multi-device access, key recovery)
		      \item What are the usability constraints? How technically sophisticated are your target users?
		      \item What performance requirements must be met?
		      \item How will you handle user authentication without compromising E2EE guarantees?
	      \end{itemize}
\end{enumerate}

\subsection{Part 2: Cryptographic Protocol Design (40 points)}

Design the core cryptographic protocol for your E2EE cloud storage system.

\begin{enumerate}
	\item \textbf{Key Hierarchy and Management (20 points):}
	      \begin{itemize}
		      \item Design a key hierarchy that supports all your functional requirements
		      \item How are keys derived from user passwords or other authentication methods?
		      \item How do you handle password changes without re-encrypting all data?
		      \item Address the key recovery problem - what happens when users forget their passwords?
		      \item If using password-based authentication, how do you prevent offline dictionary attacks?
	      \end{itemize}

	\item \textbf{File Operations and Sharing (20 points):}
	      \begin{itemize}
		      \item Specify the protocols for uploading, downloading, and deleting files
		      \item Design a secure file sharing mechanism that doesn't require re-encryption
		      \item How do you handle access revocation?
		      \item What metadata is visible to the server? How do you minimize metadata leakage?
		      \item Include clear protocol diagrams and message flows
	      \end{itemize}
\end{enumerate}

\subsection{Part 3: Implementation Considerations (20 points)}

Address practical implementation challenges for your protocol.

\begin{enumerate}
	\item \textbf{Multi-Device Synchronization (10 points):}
	      \begin{itemize}
		      \item How do users access their files from multiple devices?
		      \item Design a secure device pairing/enrollment protocol.
		      \item How do you handle device revocation when a device is lost or stolen?
		      \item What are the trade-offs between security and usability in your approach?
	      \end{itemize}

	\item \textbf{Performance and Scalability (10 points):}
	      \begin{itemize}
		      \item Analyze the computational and communication costs of your protocol.
		      \item How does your design scale to millions of users and billions of files?
		      \item What optimizations can you apply without compromising security?
		      \item Compare your approach to the schemes used by MEGA, Nextcloud, and WhatsApp
	      \end{itemize}
\end{enumerate}

\subsection{Part 4: Security Analysis (15 points)}

Provide a rigorous security analysis of your protocol.

\begin{enumerate}
	\item \textbf{Formal Security Properties (10 points):}
	      \begin{itemize}
		      \item State the formal security properties your protocol achieves.
		      \item What assumptions does your security rely on?
		      \item How would you model your protocol in ProVerif or another verification tool?
	      \end{itemize}

	\item \textbf{Attack Surface Analysis (5 points):}
	      \begin{itemize}
		      \item What attacks does your protocol prevent that affected MEGA or Nextcloud?
		      \item Are there any potential vulnerabilities in your design? How do you mitigate them?
		      \item What happens if your implementation has bugs similar to Nextcloud's?
	      \end{itemize}
\end{enumerate}

\begin{tcolorbox}[colframe=EarthBrown!30!white,colback=EarthBrown!5!white]
	\textbf{Bonus Challenge: Advanced Features (30 extra points)}

	Extend your protocol design to support one of the following advanced features:

	\begin{enumerate}
		\item \textbf{Secure Computation on Encrypted Data:} Come up with a high-level description for a mechanism that allows the server to perform useful operations (search, deduplication, compression) on encrypted files without learning their contents. What cryptographic techniques would you use? You don't need to actually come up with a full design (could you imagine? All that for a bonus question? Sheesh!) â€” just credibly investigate which technologies you'd look into, and estimate their implementation and performance costs.

		\item \textbf{Post-Compromise Security:} Enhance your protocol to provide security guarantees even after temporary key compromise. How quickly can your system recover security after a breach? Design a key rotation mechanism that maintains backward and forward secrecy.

		\item \textbf{Decentralized Trust:} Redesign your system to eliminate single points of trust. Could you distribute trust across multiple providers or use blockchain technology? How would this affect usability and performance? Address the challenges of consensus and availability.
	\end{enumerate}

	Your extended design should maintain all the security properties of your base protocol while adding these new capabilities. Provide clear specifications and analyze the additional complexity introduced.
\end{tcolorbox}

\end{document}
