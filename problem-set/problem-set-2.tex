\documentclass[10pt,a4paper,american]{exam}
\usepackage{../misc/macros/classhandout}

\title{Applied Cryptography - Problem Set 2: Symmetric Cryptography}
\author{Nadim Kobeissi}
\subject{Problem set covering symmetric cryptography topics including pseudorandomness, chosen-plaintext/ciphertext attacks, hash functions, and applied cryptography case studies.}
\keywords{pseudorandom generators, PRF, PRP, stream ciphers, CPA security, CCA security, authenticated encryption, AES-GCM, hash functions, collision resistance, password hashing, block cipher modes}

\begin{document}
\classhandoutheader
\section*{Problem Set 2: Symmetric Cryptography}

\begin{tcolorbox}[colframe=OliveGreen!30!white,colback=OliveGreen!5!white]
	\textbf{Instructions:} This problem set covers topics in provable security from topics 1.4\footnote{\url{https://appliedcryptography.page/slides/\#1-4}}, 1.5\footnote{\url{https://appliedcryptography.page/slides/\#1-5}} and 1.6\footnote{\url{https://appliedcryptography.page/slides/\#1-6}} of the course. Submit your solutions as a neatly formatted PDF. You are encouraged to collaborate with classmates in studying the material, but your submitted solutions must be your own work. For proofs, clearly state your assumptions, steps, and conclusions.
\end{tcolorbox}

\section{Pseudorandomness}
\begin{questions}
	\question[10] \textbf{Pseudorandom Generators}

	\begin{parts}
		\part[5] Explain the limitations of the one-time pad for practical encryption and why pseudorandom generators (PRGs) are needed in modern cryptographic systems.

		\part[5] Analyze the security implications of the following PRG construction, where $G$ is a secure PRG:
		\begin{align*}
			H(S) = A \| B \| C \| D \text{ where } A \| B = G(S) \text{ and } C \| D = G(B)
		\end{align*}
		Determine whether $H$ is a secure PRG. If not, provide a distinguisher that can tell apart $H(S)$ from a truly random string with non-negligible advantage.
	\end{parts}

	\question[10] \textbf{Pseudorandom Functions and Permutations}

	\begin{parts}
		\part[5] Consider the following PRF construction: $F(K, X) = G(K) \oplus X$, where $G$ is a secure PRG. Is $F$ a secure PRF? If not, describe a distinguisher that can effectively tell $F$ apart from a random function.

		\part[5] Compare and contrast PRFs and PRPs:
		\begin{subparts}
			\subpart Explain the key differences in their definitions and properties.
			\subpart Describe how PRPs can be ``downgraded'' to PRFs, but not necessarily vice versa.
			\subpart Explain why collisions are inevitable for PRFs but not for PRPs.
		\end{subparts}
	\end{parts}
\end{questions}

\section{Chosen-Plaintext and Chosen-Ciphertext Attacks}
\begin{questions}
	\question[10] \textbf{CPA Security}

	\begin{parts}
		\part[5] Consider the CPA security definition:
		\begin{center}
			\sslinked{
				\sslibrary{\Sigma}{cpa-real}{
					$K \twoheadleftarrow \Sigma.\mathcal{K}$\\[1em]
					\sslibrarysubroutine{cpa.enc}{M}{
						$C \coloneq \Sigma.\texttt{Enc}(K, M)$\\
						return $C$
					}{1}
				}{0.8}
			}{\approxeq}{
				\sslibrary{\Sigma}{cpa-rand}{
					\sslibrarysubroutine{cpa.enc}{M}{
						$C \twoheadleftarrow \Sigma.\mathcal{C}(|M|)$\\
						return $C$
					}{1}
				}{0.8}
			}
		\end{center}
		\begin{subparts}
			\subpart Explain why deterministic encryption schemes always fail CPA security.
			\subpart Construct a simple distinguisher program that can break the CPA security of any deterministic encryption scheme.
			\subpart Analyze what practical security vulnerabilities exist in systems that use non-CPA-secure encryption.
		\end{subparts}

		\part[5] For each of the following encryption schemes, determine whether it achieves CPA security. If not, provide a specific attack:
		\begin{subparts}
			\subpart $\textsf{Enc}(K, M) = (R, F(K, R) \oplus M)$ where $R \twoheadleftarrow \{0,1\}^{\lambda}$ and $F$ is a secure PRF.
			\subpart $\textsf{Enc}(K, M) = (R, F(K, M) \oplus R)$ where $R \twoheadleftarrow \{0,1\}^{\lambda}$ and $F$ is a secure PRF.
			\subpart AES in Electronic Codebook (ECB) mode.
			\subpart AES in Counter (CTR) mode with a randomly chosen IV.
		\end{subparts}
	\end{parts}

	\question[10] \textbf{CCA Security and Authenticated Encryption}

	\begin{parts}
		\part[3] Format oracle attacks:
		\begin{subparts}
			\subpart Explain how the null-oracle attack works against CTR mode encryption and why it's devastating despite CTR mode being CPA-secure.
			\subpart Describe a real-world scenario where a format oracle might be inadvertently exposed in a cryptographic system.
			\subpart Calculate the approximate number of oracle queries needed to recover a 1 KB file using the null-oracle attack, and explain why this is practical for an attacker.
		\end{subparts}

		\part[4] For the following encryption scheme constructions, determine whether each provides CCA security and/or authenticated encryption (AE). Justify your answers with brief explanations:
		\begin{subparts}
			\subpart Encrypt-then-MAC: $C = \textsf{Enc}(K_e, M)$, $T = \textsf{MAC}(K_m, C)$, output $(C, T)$
			\subpart Encrypt-and-MAC: $C = \textsf{Enc}(K_e, M)$, $T = \textsf{MAC}(K_m, M)$, output $(C, T)$
			\subpart MAC-then-encrypt: $T = \textsf{MAC}(K_m, M)$, $C = \textsf{Enc}(K_e, M\|T)$, output $C$
			\subpart Explain a scenario where replay attacks could succeed even against a system using authenticated encryption, and how associated data (AD) addresses this vulnerability.
		\end{subparts}

		\part[3] AES-GCM (Galois/Counter Mode):
		\begin{subparts}
			\subpart Explain how AES-GCM combines CTR mode encryption with Galois field multiplication for authentication. What security advantages does this provide over using separate encryption and MAC algorithms?
			\subpart Describe the critical security implications of nonce reuse in AES-GCM. What specific vulnerabilities arise when the same nonce is used for multiple messages?
			\subpart AES-GCM is sometimes implemented with different tag lengths. Analyze the security tradeoffs when using 128-bit tags versus 64-bit or 32-bit tags.
			\subpart Aside from nonce reuse, what is an unexpected vulnerability in AES-GCM that developers and engineers might not be aware of, but that might significantly impact the security of their software?
		\end{subparts}
	\end{parts}
\end{questions}

\section{Collision-Resistant Hash Functions}
\begin{questions}
	\question[15] \textbf{Hash Function Properties}

	\begin{parts}
		\part[5] Collision resistance:
		\begin{subparts}
			\subpart Explain why collisions must exist in any hash function that maps arbitrary-length inputs to fixed-length outputs.
			\subpart Using the birthday paradox, calculate approximately how many hashes must be computed to find a collision with 50\% probability in a 256-bit secure hash function.
			\subpart Describe a practical attack scenario where finding hash collisions would compromise a security system.
		\end{subparts}

		\part[5] Hash function construction:
		\begin{subparts}
			\subpart Compare and contrast the Merkle-Damg\aa rd construction (used in SHA-2) and the Sponge construction (used in SHA-3).
			\subpart Explain how length extension attacks work against Merkle-Damg\aa rd hash functions and why the Sponge construction is resistant to these attacks.
			\subpart Describe the HMAC construction and explain how it protects against length extension attacks.
		\end{subparts}

		\part[5] Hash function evolution:
		\begin{subparts}
			\subpart Describe the successful attacks against MD5 and SHA-1 that led to their deprecation.
			\subpart Explain the concept of chosen-prefix collisions and why they are particularly dangerous for certificate authorities.
			\subpart Compare the security of SHA-2 and SHA-3 against known cryptanalytic techniques.
		\end{subparts}
	\end{parts}

	\question[15] \textbf{Password Hashing}

	\begin{parts}
		\part[5] For each of the following password storage approaches, analyze the security implications if a server database is compromised:
		\begin{subparts}
			\subpart Storing passwords in plaintext.
			\subpart Encrypting passwords with a key stored on the same server.
			\subpart Storing unsalted SHA-256 hashes of passwords.
			\subpart Storing salted SHA-256 hashes of passwords.
			\subpart Using a specialized password hashing function like Scrypt.
		\end{subparts}

		\part[5] Salting:
		\begin{subparts}
			\subpart Explain how salt protects against precomputation attacks like rainbow tables.
			\subpart Calculate the storage requirements for properly salted password hashes, assuming 10,000 users, 16-byte salts, and 32-byte hash outputs.
			\subpart Describe best practices for generating and storing salts.
		\end{subparts}

		\part[5] Specialized password hashing functions:
		\begin{subparts}
			\subpart Explain why memory-hard functions like Scrypt provide better protection against specialized hardware attacks compared to PBKDF2.
			\subpart Describe how each of Scrypt's parameters (N, r, p) affect its security and performance.
			\subpart Compare the relative speeds of SHA-256, PBKDF2, and Scrypt for password hashing, and explain the security implications of these speed differences.
		\end{subparts}
	\end{parts}
\end{questions}

\section{Applied Cryptography Case Studies}
\begin{questions}
	\question[10] \textbf{Block Cipher Modes Analysis}

	With reference to the block cipher modes covered in our lectures, analyze the following scenarios:
	\begin{parts}
		\part A secure file storage application needs to encrypt user files at rest. Compare CBC, CTR, and AES-GCM modes for this application, discussing:
		\begin{itemize}
			\item Performance implications for large files.
			\item Error propagation if parts of the ciphertext are corrupted.
			\item The security implications of IV/nonce reuse.
			\item Data integrity guarantees and the advantages of authenticated encryption with AES-GCM.
		\end{itemize}
		\part A real-time messaging application needs to encrypt short messages with minimal latency. Compare CBC, CTR, and AES-GCM modes for this application, discussing:
		\begin{itemize}
			\item Parallelizability for encryption/decryption.
			\item Suitability for streaming data.
			\item Protection against chosen-ciphertext attacks.
			\item How AES-GCM addresses authentication needs compared to unauthenticated modes.
		\end{itemize}
		\part For AES-GCM specifically:
		\begin{itemize}
			\item Explain the security impact of nonce reuse in AES-GCM compared to nonce reuse in CTR mode.
			\item Discuss the performance tradeoffs of AES-GCM compared to using separate encryption (CTR mode) and authentication (HMAC).
			\item Explain how AES-GCM's authenticated encryption properties protect against attacks that would succeed against CBC or CTR modes.
		\end{itemize}
	\end{parts}

	\question[10] \textbf{Hash Function Security Analysis}

	A software update system uses hash functions to verify the integrity of downloads. The system works as follows:
	\begin{itemize}
		\item The software vendor posts SHA-1 hashes of legitimate update files on their HTTPS website.
		\item Users download the update file over HTTP (not HTTPS) for bandwidth efficiency.
		\item The update client verifies the downloaded file by computing its SHA-1 hash and comparing it to the hash obtained from the HTTPS website.
		\item If the hashes match, the update is installed automatically.
	\end{itemize}

	Analyze this system:
	\begin{parts}
		\part Identify at least three security vulnerabilities in this design.
		\part For each vulnerability, describe a specific attack scenario.
		\part Propose improvements to address each vulnerability while maintaining performance and usability.
		\part Design a more secure alternative system using modern cryptographic primitives discussed in class.
	\end{parts}

	\question[10] \textbf{Password Management System Design}

	You are designing a password management system for a new web application with the following requirements:
	\begin{itemize}
		\item Users must be able to securely recover their account if they forget their password.
		\item The system must be resistant to offline dictionary attacks if the database is compromised.
		\item The system must support high-performance authentication for a large user base.
		\item The system should detect and prevent credential stuffing attacks.
	\end{itemize}

	Design and analyze a complete solution:
	\begin{parts}
		\part Specify which cryptographic primitives you would use for password storage and why.
		\part Describe your password recovery mechanism and analyze its security properties.
		\part Explain how your system balances security and performance requirements.
		\part Analyze potential vulnerabilities in your design and how they are mitigated.
	\end{parts}
\end{questions}

\begin{tcolorbox}[colframe=EarthBrown!30!white,colback=EarthBrown!5!white]
	\section*{Bonus Question}
	\begin{questions}
		\bonusquestion[20] The security of AES and other block ciphers depends on their resistance to various forms of cryptanalysis. Research and analyze one of the following advanced attacks:

		\begin{parts}
			\part \textbf{Side-channel attacks}: Explain how timing attacks, power analysis, or cache attacks can leak information about encryption keys in practical implementations of AES.
			\part \textbf{Related-key attacks}: Describe how related-key attacks work against block ciphers and why they are significant even when normal usage involves only unrelated keys.
			\part \textbf{Quantum attacks}: Analyze the impact of Grover's algorithm on the security of AES with different key sizes (128, 192, 256 bits) and discuss appropriate post-quantum key length recommendations.
		\end{parts}

		Your answer should include: a description of the attack, its practical feasibility, relevant examples of successful implementations against real systems, and appropriate countermeasures.
	\end{questions}
\end{tcolorbox}

\end{document}
