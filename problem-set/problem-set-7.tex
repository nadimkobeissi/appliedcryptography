\documentclass[10pt,a4paper,american]{exam}
\usepackage{../misc/macros/classhandout}

\title{Applied Cryptography - Problem Set 7: Post-Quantum Cryptography}
\author{Nadim Kobeissi}
\subject{Problem set covering post-quantum cryptography concepts including quantum threats, algorithm selection, protocol design, and real-world deployment challenges.}
\keywords{post-quantum cryptography, quantum computing, Shor's algorithm, Grover's algorithm, ML-KEM, ML-DSA, SLH-DSA, hybrid cryptography, TLS, secure messaging}

\begin{document}
\classhandoutheader
\section*{Problem Set 7: Post-Quantum Cryptography}

\begin{tcolorbox}[colframe=OliveGreen!30!white,colback=OliveGreen!5!white]
	\textbf{Instructions:} This problem set covers topics in post-quantum cryptography from topic 2.6\footnote{\url{https://appliedcryptography.page/slides/\#2-6}} of the course. Submit your solutions as a neatly formatted PDF. You are encouraged to collaborate with classmates in studying the material, but your submitted solutions must be your own work. For proofs, clearly state your assumptions, steps, and conclusions.
\end{tcolorbox}

\section*{Quantum Computing and Cryptographic Impact}
\begin{questions}
	\question[20] \textbf{Understanding the Quantum Threat}

	\begin{parts}
		\part[10] \textbf{Quantum Algorithms and Their Impact:}
		You are advising a financial institution on their post-quantum migration strategy. They currently use Curve25519 for key exchange and AES-128 for symmetric encryption.
		\begin{subparts}
			\subpart Explain how Shor's algorithm would break their Curve25519 implementation. What is the fundamental mathematical operation that quantum computers can perform efficiently that classical computers cannot? Be specific about the polynomial vs. exponential time complexity difference.
			\subpart Their security team argues that since Grover's algorithm only provides a quadratic speedup against AES-128, they don't need to upgrade their symmetric cryptography. Evaluate this claim. If a quantum computer capable of running Shor's algorithm existed, what would be the effective security level of AES-128 against Grover's algorithm? Should they upgrade to AES-256?
		\end{subparts}

		\part[10] \textbf{Store-Now-Decrypt-Later Analysis:}
		A healthcare provider stores patient records encrypted with current cryptographic standards. These records must remain confidential for 50 years due to regulatory requirements.
		\begin{subparts}
			\subpart[5] Analyze the store-now-decrypt-later (SNDL) threat for this scenario. Given current quantum computing progress (as of 2025), when might adversaries who intercept data today be able to decrypt it? Consider both optimistic and pessimistic timelines from the quantum threat timeline presented in class.
			\subpart[5] The provider uses TLS 1.3 with ECDHE for key exchange. Explain why forward secrecy doesn't protect against SNDL attacks in the quantum context. How would implementing post-quantum TLS today help, and what are the trade-offs?
		\end{subparts}
	\end{parts}

	\question[15] \textbf{Quantum Computing Reality Check}

	\begin{parts}
		\part[7.5] \textbf{Evaluating Quantum Progress:}
		Recent news claims a breakthrough in quantum computing: ``Quantum computer factors RSA-2048!''
		\begin{subparts}
			\subpart Based on the course material\footnote{\url{https://appliedcryptography.page/paper/\#quantum-dog}} about current quantum factorization records and ``sleight-of-hand'' numbers, what questions would you ask to evaluate this claim? List at least three specific technical details you would investigate.
			\subpart The paper reveals they factored a number where the two prime factors differ by 2. Explain why this is not a valid demonstration of breaking RSA-2048 and how it could be solved on classical hardware from the 1980s.
		\end{subparts}

		\part[7.5] \textbf{Engineering Challenges:}
		You're on a government panel evaluating quantum computing threats to national security.
		\begin{subparts}
			\subpart Explain three major engineering challenges that must be overcome before quantum computers can break real cryptographic systems. For each, describe the current state of the art and what improvements are needed.
			\subpart The panel asks: ``Should we panic about quantum computers if they can't even outperform a trained dog at factoring?'' How would you provide a balanced response that acknowledges both the current limitations and future risks?
			\subpart Given the gap between quantum hype and reality, justify why organizations should still begin post-quantum migration now rather than waiting for more capable quantum computers.
		\end{subparts}
	\end{parts}
\end{questions}

\section*{Post-Quantum Protocol Design and Deployment}
\begin{questions}
	\question[15] \textbf{Post-Quantum TLS}

	\begin{parts}
		\part[7.5] \textbf{Hybrid Key Agreement:}
		Current deployments of TLS 1.3 use X25519 + ML-KEM-768 hybrid key agreement.
		\begin{subparts}
			\subpart Explain why hybrid approaches are used rather than pure post-quantum. Consider both security and practical reasons. What specific attack scenarios does each component protect against?
			\subpart The X-Wing KEM\footnote{\url{https://appliedcryptography.page/paper/\#xwing-hybrid}} combines X25519 and ML-KEM-768 in an optimized way. What efficiency gains does a purpose-built hybrid construction provide over generic combination methods? Why can X-Wing provide stronger security proofs than generic combiners? Refer to the X-Wing paper.
			\subpart Given that ML-KEM is faster than X25519 in operations per second, why do we still see the size difference (32 bytes vs 1KB+) as a significant deployment challenge?
		\end{subparts}

		\part[7.5] \textbf{Deployment Challenges:}
		You're implementing post-quantum TLS for Cloudflare, a major Content Delivery Network (CDN).
		\begin{subparts}
			\subpart The \texttt{ClientHello} size problem caused a 5-year delay in Chrome's PQ deployment. Explain what ossification means in this context and why some middleboxes fail when \texttt{ClientHello} exceeds one packet. How does GREASE help prevent future ossification?
			\subpart For CDN-to-origin connections, describe the trade-offs between the ``fast way'' (immediate PQ keyshare) and ``safe way'' (wait for \texttt{HelloRetryRequest}). Given a 0.34\% connection failure rate for the fast way, how would you decide which approach to use?
			\subpart As of 2025, 38\% of TLS connections use post-quantum cryptography. What are the remaining barriers to reaching 100\%? Consider both technical and ecosystem challenges.
		\end{subparts}
	\end{parts}

	\question[20] \textbf{Post-Quantum Messaging}

	\begin{parts}
		\part[10] \textbf{Comparing PQ3 and Signal's Approach:}
		Apple's PQ3 and Signal's PQXDH/Triple Ratchet take different approaches to post-quantum messaging.
		\begin{subparts}
			\subpart Compare how Apple's PQ3 and Signal's PQXDH handle the initial key agreement. While Signal's PQXDH is limited to adding post-quantum cryptography only to the setup phase, Apple's PQ3 integrates post-quantum cryptography into the ratcheting phase as well. What are the advantages of Apple's PQ3 integrating post-quantum cryptography into the ratcheting process?
			\subpart PQ3 sends new ML-KEM keys every ~50 messages due to bandwidth constraints. Explain why this is problematic for unbalanced conversations (where one party sends many messages without response).
		\end{subparts}

		\part[10] \textbf{Engineering Post-Quantum Messaging:}
		You're designing a post-quantum secure messaging app for a government agency.
		\begin{subparts}
			\subpart[5] The agency requires post-compromise security against quantum adversaries. Compare the approaches of PQ3 (periodic KEM ratcheting) versus Triple Ratchet (parallel classical and PQ ratchets). Which provides better security properties and why? Consider the trade-off between security and bandwidth.
			\subpart[5] Your app needs to work on bandwidth-constrained satellite links. Design a ratcheting strategy that balances post-quantum security with bandwidth efficiency. How would you adapt the erasure coding approach from Triple Ratchet? What would be your criteria for when to perform a PQ ratchet step?
		\end{subparts}
	\end{parts}
\end{questions}

\section*{Post-Quantum Algorithm Selection and Engineering}
\begin{questions}
	\question[15] \textbf{Choosing the Right Tool}

	\begin{parts}
		\part[7.5] \textbf{Algorithm Selection for Real Systems:}
		You're the lead cryptographic engineer for a company building three different products: a secure messaging app, a software update system, and a high-frequency trading platform.
		\begin{subparts}
			\subpart For each system, recommend whether to use ML-KEM, ML-DSA, or SLH-DSA (or a combination). Justify your choices based on the specific operational requirements, performance constraints, and threat models of each system.
			\subpart The messaging app team wants to use algorithms with the same underlying mathematical problems and assumptions for both key exchange and signatures to ``simplify implementation.'' Evaluate this proposal. What are the security and engineering implications of using one algorithm family for multiple purposes?
			\subpart Your trading platform processes 1 million transactions per second. The team discovers that ML-DSA verification is the bottleneck. What engineering solutions would you propose? Consider both cryptographic alternatives and system architecture changes.
		\end{subparts}

		\part[7.5] \textbf{Living with Large Keys:}
		Post-quantum algorithms have significantly larger keys and ciphertexts than classical alternatives. The ``size doesn't matter'' argument says modern networks can handle larger keys. Challenge this argument by identifying a specific scenario where post-quantum key sizes create real engineering problems. Propose a mitigation strategy.
	\end{parts}

	\question[15] \textbf{Migration Engineering}

	\begin{parts}
		\part[7.5] \textbf{Backwards Compatibility Nightmares:}
		You're migrating a 20-year-old payment processing system to post-quantum cryptography.
		\begin{subparts}
			\subpart The system has hardcoded assumptions about 2048-bit Diffie-Hellman key sizes throughout the codebase. Design a migration strategy that allows gradual rollout without breaking existing integrations. How would you handle the transition period where some nodes are post-quantum and others aren't?
			\subpart Legacy Hardware Security Modules (HSMs) can't be upgraded to support post-quantum algorithms. Propose a hybrid architecture that provides post-quantum security while still utilizing the existing HSM investment. What are the security trade-offs?
			\subpart During testing, you discover that post-quantum signatures cause some database fields to overflow. The database schema can't be changed due to regulatory requirements. How would you engineer around this constraint while maintaining security?
		\end{subparts}

		\part[7.5] \textbf{Performance vs. Security Trade-offs:}
		A major cloud provider is implementing post-quantum cryptography across their infrastructure.
		\begin{subparts}
			\subpart They observe that ML-KEM key generation is 100x slower than X25519. For a service handling millions of ephemeral connections per second, is this a problem? Design a key management strategy that balances security with performance requirements.
			\subpart Propose a monitoring and alerting system that would detect if post-quantum cryptographic operations are becoming a performance bottleneck. What metrics would you track, and what automatic mitigations could the system trigger?
		\end{subparts}
	\end{parts}
\end{questions}

\begin{tcolorbox}[colframe=EarthBrown!30!white,colback=EarthBrown!5!white]
	\section*{Bonus Question}
	\begin{questions}
		\bonusquestion[30] Dr. Gaster, a rogue physicist who gained superintelligence after falling into his own creation, has decided to ``help'' the world transition to post-quantum cryptography by selectively breaking classical cryptosystems. However, their quantum computer is peculiar -- it only works on Tuesdays, can only run for 5 minutes before needing a 24-hour cooldown, and makes an extremely loud humming noise that can be heard from space. The International Space Station reports that Dr. Gaster's quantum computer produces a humming noise so loud it interferes with their meditation sessions and causes spontaneous dance parties among the astronauts. The frequency analysis reveals it's playing a continuous loop of Rick Astley's \textit{``Never Gonna Give You Up''} at 142 decibels, audible from low Earth orbit. NASA is concerned this constitutes the first documented case of quantum rickrolling and may violate several intergalactic noise ordinances.

		Analyze Dr. Gaster's impact on global cryptographic infrastructure:
		\begin{parts}
			\part[10] \textbf{Attack Strategy:} Given the constraints of Dr. Gaster's quantum computer, what would be the most effective targets? Consider the difference between attacking live TLS sessions versus stored encrypted data, and between breaking encryption versus signatures. How would the Tuesday-only operation affect which systems are vulnerable? Design a detection system that organizations could use to know when they're under quantum attack.

			\part[10] \textbf{Prioritizing Defense:} You're the CISO of a major tech company. Based on Google's threat model discussed in class, create a prioritized list of systems to migrate to post-quantum cryptography. For each system type (TLS, firmware signatures, authentication tokens, etc.), explain whether Dr. Gaster's attacks make it more or less urgent to migrate. How would you handle systems where post-quantum solutions have significant drawbacks?

			\part[10] \textbf{The Quantum Rickroll Paradox:} Dr. Gaster's musical quantum computer has created an unexpected side effect: the quantum rickrolling frequency interferes with certain post-quantum algorithms, causing them to fail verification 0.1\% of the time when the humming is active. You discover that ML-KEM-768 experiences increased decapsulation failures during Tuesday quantum rickrolls, while SLH-DSA signatures become temporarily invalid due to quantum interference patterns matching Rick Astley's vocal frequencies. The UN Security Council is debating whether quantum rickrolling constitutes a form of cyber warfare. As their technical advisor, explain why this interference might actually help organizations test their post-quantum migration readiness. How could you use Dr. Gaster's predictable attack pattern as a stress test for hybrid cryptographic systems?
		\end{parts}
	\end{questions}
\end{tcolorbox}

\end{document}
